@* @model List<EShop.Domain.Domain_Models.Product> *@

@* @{ *@
@*     ViewData["Title"] = "Index"; *@
@*     Layout = "~/Views/Shared/_Layout.cshtml"; *@
@* } *@
@* <div class="container"> *@

@*     <div class="row"> *@
@*         <a class="btn btn-success" style="width:200px; margin-left:28px" asp-action="Create">Insert New Product</a> *@
@*     </div> *@

@*     @for (int i = 0; i < Model.Count; i++) *@
@*     { *@
@*         var item = Model[i]; *@

@*         @if(i%3 == 0) *@
@*         { *@
@*             @:<div class="row"> *@
@*         } *@

@*                 <div class="col-3 m-3"> *@

@*                     <div class="card" style="width: 20rem; height: 30rem;"> *@
@*                        @{ *@
@*     var imageUrl = string.IsNullOrWhiteSpace(item.ProductImage)  *@
@*         ? "https://via.placeholder.com/150x200?text=No+Image"  *@
@*         : item.ProductImage; *@
@* } *@
@* <img class="card-img-top" src="@imageUrl" style="height: 50%;" alt="Image for product!"> *@

@*                         <div class="card-body"> *@
@*                             <h3 class="card-title">@item.ProductName</h3> *@
@*                             <p class="card-text">@item.ProductDescription</p> *@


@*                             <h6>Price: @item.ProductPrice ДЕН</h6> *@
@*                         </div> *@

@*                         <div class="card-footer"> *@
@*                             <a asp-controller="Products" asp-action="AddProductToCard" asp-route-id="@item.Id" class="btn btn-info">Add to Card</a> *@
@*                             <a asp-controller="Products" asp-action="Edit" asp-route-pid="@item.Id" class="btn btn-secondary">Edit</a> *@
@*                             <a asp-controller="Products" asp-action="Delete" asp-route-id="@item.Id" class="btn btn-danger">Delete</a> *@
@*                         </div> *@
@*                     </div> *@

@*                 </div> *@

@*         @if(i%3 == 2)  *@
@*         { *@
@*             @:</div>     *@
@*         } *@
@*     } *@

@* </div> *@


@model List<EShop.Domain.Domain_Models.Product>

@{
    ViewData["Title"] = "Products";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container py-4">

    @* <div class="mb-4 d-flex justify-content-start"> *@
        @* <a class="btn btn-success btn-lg" asp-action="Create" style="min-width: 200px;">Insert New Product</a> *@
    @* </div> *@

    @for (int i = 0; i < Model.Count; i += 3)
    {
        <div class="row">
            @for (int j = i; j < i + 3 && j < Model.Count; j++)
            {
                var item = Model[j];
                var imageUrl = string.IsNullOrWhiteSpace(item.ProductImage)
                ? "https://via.placeholder.com/150x200?text=No+Image"
                : item.ProductImage;

                <div class="col-md-4 mb-4">
                    <div class="card h-100 shadow-sm border-0 rounded" style="transition: transform 0.3s;">
                        <img class="card-img-top" src="@imageUrl" alt="Image for @item.ProductName" style="height: 250px; object-fit: cover;">

                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title text-primary">@item.ProductName</h5>
                            <p class="card-text text-muted flex-grow-1" style="min-height: 60px;">
                                @(string.IsNullOrWhiteSpace(item.ProductDescription) ? "No description available" : item.ProductDescription)
                            </p>
                            <h6 class="text-success fw-bold">Price: @item.ProductPrice.ToString("N2") ДЕН</h6>
                        </div>

                        <div class="card-footer bg-transparent border-top-0 d-flex justify-content-between gap-2">
                            @if (User.Identity.IsAuthenticated)
                            {
                                <a asp-controller="Products" asp-action="AddProductToCard" asp-route-id="@item.Id" class="btn btn-info btn-sm flex-fill">Add to Cart</a>
                            }
                            else
                            {
                                <a asp-area="Identity" asp-page="/Account/Login" class="btn btn-warning btn-sm flex-fill">
                                    <i class="bi bi-person-lock me-1"></i>Login to Add to Cart
                                </a>
                            }
                            @* <a asp-controller="Products" asp-action="Edit" asp-route-pid="@item.Id" class="btn btn-secondary btn-sm flex-fill">Edit</a> *@
                            @* <a asp-controller="Products" asp-action="Delete" asp-route-id="@item.Id" class="btn btn-danger btn-sm flex-fill">Delete</a> *@
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>

<style>
    .card:hover {
        transform: translateY(-8px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    }
</style>
